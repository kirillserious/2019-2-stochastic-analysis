\section{Задание №2}

\begin{enumerate}
        \item Построить датчик сингулярного распределения, имеющий в качестве функции распределения канторову лестницу. С помощью критерия Колмогорова убедиться в корректности работы датчика.
        \item Для канторовых случайных величин проверить свойство симметричности относительно $\frac12$ ($X$ и $(1 - X)$ распределены одинаково) и самоподобия относительно деления на $3$ (условное распределение $Y$ при условии $Y\in[0,\,\frac13]$ совпадает с распределением $\frac{Y}{3}$) с помощью критерия Смирнова.
        \item Вычислить значение математического ожидания и дисперсии с эмпирическими для разного объема выборок. Проиллюстрировать сходимость.
\end{enumerate}


\subsection{Задача №1}

\begin{definition}
        Пусть дано вероятностное пространство $(\R,\, \mathcal{F},\,\p)$, и на нем определена случайная величина $\xi$ с распределением $\p_\xi$. Тогда \textit{функцией распределения} случайной величины $X$ называется функция $F_\xi:\,\R\to[0,\,1]$, задаваемая формулой:
        $$
                F_\xi(x) = \p(\xi\leqslant x) \equiv \p_\xi(\,(-\infty,\,x]\,). 
        $$
\end{definition}

\begin{definition}
        Функция распределения некоторой случайной величины называется \textit{сингулярной}, если она непрерывна и ее множество точек роста имеет нулевую меру Лебега.
\end{definition}

\begin{definition}
        Из единичного отрезка $C_0 = [0,\,1]$ удалим интервал $\left(\frac13,\,\frac23\right)$. Оставшееся множество обозначим за $C_1$. Множество $C_1 = \left[0,\,\frac13\right]\cup\left[\frac23,\,1\right]$ состоит из двух отрезков; удалим теперь из каждого отрезка его среднюю часть, и оставшееся множество обозначим за $C_2$. Повторив данную процедуру, то есть удаляя средние трети у всех четырех отрезков, получим $C_3$. Дальше таким же образом получаем последовательность замкнутых множеств $C_0 \supset C_1 \supset C_2 \supset \ldots \supset C_i \supset \ldots$. Пересечение
        $$
                C = \bigcap_{i=0}^{\infty} C_i
        $$
        называется \textit{канторовым множеством}.
\end{definition}

\begin{remark}
        Канторово множество так же можно определить как множество всех чисел от нуля до единицы, которые можно представить в троичной записи при помощи только нулей и двоек. То есть
        $$
                C = \{\,0,\alpha_1\,\alpha_2\,\ldots\,\alpha_i\,\ldots\,_3\:|\:\alpha_i=0,\,2\,\}.
        $$
\end{remark}

\begin{assertion}
        Канторово множество имеет нулевую меру Лебега. \cite{shiryaev}
\end{assertion}

\begin{definition}
        Рассмотрим функцию $K(x)$ такую, что в точках $0$ и $1$ значение функции принимается равным соответственно $0$ и $1$.
        Далее интервал $(0,\,1)$ разбивается на три равные части $\left(0,\,\frac {1}{3}\right)$, $\left(\frac{1}{3},\,\frac {2}{3}\right)$ и $\left(\frac{2}{3},\,1\right)$.
        На среднем сегменте полагаем $K(x)=\frac{1}{2}$.
        Оставшиеся два сегмента снова разбиваются на три равные части каждый, и на средних сегментах $K(x)$ полагается равной $\frac{1}{4}$ и $\frac{3}{4}$.
        Каждый из оставшихся сегментов снова делится на три части, и на внутренних сегментах $K(x)$ определяется как постоянная, равная среднему арифметическому между соседними, уже определенными значениями $K(x)$.
        На остальных точках единичного отрезка определяется по непрерывности.
        Полученная функция называется \textit{канторовой лестницей}. 
\end{definition}

\begin{remark}
        Из определения канторовой лестницы~$K(x)$ следует, что она действует на точки из канторова множества $C$ по следующему правилу:
        $$
                K(0,\alpha_1\,\alpha_2\,\ldots\,\alpha_i\,\ldots\,_3) =
                0,\frac{\alpha_1}2\,\frac{\alpha_2}2\,\ldots\,\frac{\alpha_i}2\,\ldots\,_2.
        $$
\end{remark}

Теперь рассмотрим случайную величину 
$$
        Y =
        0, \xi_1\,\xi_2\ldots\xi_k\,\ldots\,_2 =
        \sum_{k=1}^{\infty}\frac{\xi_k}{2^k},
        \quad
        \mbox{где $\xi_k \sim\mbox{Bern}\left(\frac12\right)$}.
$$
Такая случайная величина имеет равномерное распределение на откезке $[0,1]$, так как мы равновероятным образом выбираем знаки разложения числа~$\xi_k$ в двоичном представлении. Теперь рассмотрим искомую случайную величину~$X$, имеющую в качестве функции распределения~$F_X(x)$ канторову лестницу~$K(x)$. Образ каждой случайной величины $Y$ для такой функции будет равен
$$
        K^{-1}(Y) = \sum_{k=1}^{\infty}\frac{2\xi_k}{3^k}.
$$
Эта точка лежит в канторовом множестве.

\begin{theorem}
        Пусть некоторая функция распределения $F$ имеет обратную $F^{-1}$. Тогда функцией распределения случайной величины
        $$
                \eta = F^{-1}(\xi)
        $$
        является $F$.
\end{theorem}
\begin{proof}
        Найдем функцию распределения случайной величины $\eta$:
        $$
                F_\eta(x) =
                \p(\eta \leqslant x) =
                \p(F^{-1}(\xi) \leqslant x) =
                \p(\xi \leqslant F(x)) =
                F(x).
        $$
        Таким образом, теорема доказана.

\end{proof}

Из теоремы вытекает, что при помощи построенного ранее (см. раздел~\ref{task_01}) генератора схемы Бернулли мы можем смоделировать случайную величину $X$, принимающую с вероятностью $1$ значения из канторова множества~C и имеющую канторову лестницу~$K(x)$ в качестве функции распределения~$F_X(x)$, следующим образом:
$$
        X = \sum_{k = 1}^{\infty}\frac{2\xi_k}{3^k},
        \quad
        \mbox{где $\xi_k\sim\mbox{Bern}\left(\frac12\right)$.}
$$

В программной реализации будем рассматривать частичные суммы. Для этого этого введем погрешность $\varepsilon$ и найдем такое число $n$, при котором частичная сумма будет отличаться от бесконечной не более, чем на заданную погрешность.
$$
        \sum_{k=n}^{\infty} \frac{2\xi_k}{3^k} \leqslant 2\sum_{k=n}^{\infty}\frac{1}{3^k} = \frac{1}{3^{n-1}} \leqslant \varepsilon,
$$
$$
        \Downarrow
$$
$$
        n \geqslant 1 - \left\lceil\,\log_3 \varepsilon\,\right\rceil \; \forall \varepsilon < 1.
$$
\begin{remark}
        Из выведенной формулы также видно, что для столь малой погрешности как $\varepsilon = 10^{-9}$ достаточно использовать всего $n = 20$ первых членов ряда.
\end{remark}

\begin{figure}[h]
        \hfill
        \includegraphics[width=70mm]{task_02/cantor-100.eps}
        \hfill
        \hfill
        \includegraphics[width=70mm]{task_02/cantor-10000.eps}
        \hfill
        \caption{Эмпирическая и теоретическая функции распределения <<канторовой>> случайной величины $X$ при выборке из $100$~испытаний~(слева) и $10^4$~испытаний~(справа).}
\end{figure}

\texttt{Дописать проверку того, является ли функция распределения $X$ канторовой лестницей при помощи критерия Колмогорова.}

\subsection{Задача №2}

\subsection{Задача №3}

Вычислим значение математического ожидания для построенной случайной величины $X$:
$$
        \E\,X
        =
        \E\sum_{k=1}^{\infty}\frac{2\xi_k}{3^k}
        =
        \sum_{k=1}^{\infty}\frac{2}{3^k}\E\xi_k=
        \sum_{k=1}^\infty \frac{2}{3^k}\cdot\frac12
        =
        \frac{\frac13}{1 - \frac13}
        =
        \frac{1}{2}.
$$
Теперь, помня о независимости случайных величин $\xi_k\;k\in\N$, вычислим значение дисперсии
$$
        \Var\,X
        =
        \Var\sum_{k=1}^{\infty}\frac{2\xi_k}{3^k}
        =
        \sum_{k=1}^{\infty}\left(\frac{2}{3^k}\right)^2\Var\,\xi_k
        =
        \sum_{k=1}^{\infty}\frac{4}{9^k}\cdot\frac14
        =
        \frac{\frac19}{1 - \frac19}
        =
        \frac18.
$$
\begin{remark}
        При подсчете мы использовали известные значения для математического ожидания и дисперсии бернуллиевой случайной величины $\xi\sim\mbox{Bern}(p)$:
        $$
                \E\,\xi = p
                \quad
                \mbox{и}
                \quad
                \Var\,\xi = p(1-p).
        $$
\end{remark}